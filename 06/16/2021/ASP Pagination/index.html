<!DOCTYPE html><html lang="en" data-theme="light"><head><meta charset="UTF-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width,initial-scale=1"><title>ASP Automapper Usage For Entity Framework | Saige Blog</title><meta name="keywords" content="notes,Entity Framework,Automapper"><meta name="author" content="Shiqi Zhang"><meta name="copyright" content="Shiqi Zhang"><meta name="format-detection" content="telephone=no"><meta name="theme-color" content="#ffffff"><meta name="description" content="IntroductionAutomapper could use user defined mapping profile or built-in mapping. It mapped from the entites(source) to models(desitination).  CodeMovieDetailResponseModel has two inner class CastRes">
<meta property="og:type" content="article">
<meta property="og:title" content="ASP Automapper Usage For Entity Framework">
<meta property="og:url" content="http://pajarnas.github.io/06/16/2021/ASP%20Pagination/index.html">
<meta property="og:site_name" content="Saige Blog">
<meta property="og:description" content="IntroductionAutomapper could use user defined mapping profile or built-in mapping. It mapped from the entites(source) to models(desitination).  CodeMovieDetailResponseModel has two inner class CastRes">
<meta property="og:locale" content="en_US">
<meta property="og:image" content="https://cdn.jsdelivr.net/npm/butterfly-extsrc@1/img/default.jpg">
<meta property="article:published_time" content="2021-06-16T05:00:00.000Z">
<meta property="article:modified_time" content="2021-06-19T17:34:02.351Z">
<meta property="article:author" content="Shiqi Zhang">
<meta property="article:tag" content="notes">
<meta property="article:tag" content="Entity Framework">
<meta property="article:tag" content="Automapper">
<meta name="twitter:card" content="summary">
<meta name="twitter:image" content="https://cdn.jsdelivr.net/npm/butterfly-extsrc@1/img/default.jpg"><link rel="shortcut icon" href="/img/favicon.png"><link rel="canonical" href="http://pajarnas.github.io/06/16/2021/ASP%20Pagination/"><link rel="preconnect" href="//cdn.jsdelivr.net"/><link rel="preconnect" href="//busuanzi.ibruce.info"/><link rel="stylesheet" href="/css/index.css"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/@fortawesome/fontawesome-free/css/all.min.css" media="print" onload="this.media='all'"><script>const GLOBAL_CONFIG = { 
  root: '/',
  algolia: undefined,
  localSearch: undefined,
  translate: undefined,
  noticeOutdate: undefined,
  highlight: {"plugin":"highlighjs","highlightCopy":true,"highlightLang":true},
  copy: {
    success: 'Copy successfully',
    error: 'Copy error',
    noSupport: 'The browser does not support'
  },
  relativeDate: {
    homepage: false,
    post: false
  },
  runtime: 'days',
  date_suffix: {
    just: 'Just',
    min: 'minutes ago',
    hour: 'hours ago',
    day: 'days ago',
    month: 'months ago'
  },
  copyright: undefined,
  lightbox: 'fancybox',
  Snackbar: undefined,
  source: {
    jQuery: 'https://cdn.jsdelivr.net/npm/jquery@latest/dist/jquery.min.js',
    justifiedGallery: {
      js: 'https://cdn.jsdelivr.net/npm/justifiedGallery/dist/js/jquery.justifiedGallery.min.js',
      css: 'https://cdn.jsdelivr.net/npm/justifiedGallery/dist/css/justifiedGallery.min.css'
    },
    fancybox: {
      js: 'https://cdn.jsdelivr.net/npm/@fancyapps/fancybox@latest/dist/jquery.fancybox.min.js',
      css: 'https://cdn.jsdelivr.net/npm/@fancyapps/fancybox@latest/dist/jquery.fancybox.min.css'
    }
  },
  isPhotoFigcaption: false,
  islazyload: false,
  isanchor: false
}</script><script id="config-diff">var GLOBAL_CONFIG_SITE = { 
  isPost: true,
  isHome: false,
  isHighlightShrink: false,
  isToc: true,
  postUpdate: '06-19-2021 12:34:02'
}</script><noscript><style type="text/css">
  #nav {
    opacity: 1
  }
  .justified-gallery img {
    opacity: 1
  }

  #recent-posts time,
  #post-meta time {
    display: inline !important
  }
</style></noscript><script>(win=>{
    win.saveToLocal = {
      set: function setWithExpiry(key, value, ttl) {
        if (ttl === 0) return
        const now = new Date()
        const expiryDay = ttl * 86400000
        const item = {
          value: value,
          expiry: now.getTime() + expiryDay,
        }
        localStorage.setItem(key, JSON.stringify(item))
      },

      get: function getWithExpiry(key) {
        const itemStr = localStorage.getItem(key)

        if (!itemStr) {
          return undefined
        }
        const item = JSON.parse(itemStr)
        const now = new Date()

        if (now.getTime() > item.expiry) {
          localStorage.removeItem(key)
          return undefined
        }
        return item.value
      }
    }
  
    win.getScript = url => new Promise((resolve, reject) => {
      const script = document.createElement('script')
      script.src = url
      script.async = true
      script.onerror = reject
      script.onload = script.onreadystatechange = function() {
        const loadState = this.readyState
        if (loadState && loadState !== 'loaded' && loadState !== 'complete') return
        script.onload = script.onreadystatechange = null
        resolve()
      }
      document.head.appendChild(script)
    })
  
      win.activateDarkMode = function () {
        document.documentElement.setAttribute('data-theme', 'dark')
        if (document.querySelector('meta[name="theme-color"]') !== null) {
          document.querySelector('meta[name="theme-color"]').setAttribute('content', '#0d0d0d')
        }
      }
      win.activateLightMode = function () {
        document.documentElement.setAttribute('data-theme', 'light')
        if (document.querySelector('meta[name="theme-color"]') !== null) {
          document.querySelector('meta[name="theme-color"]').setAttribute('content', '#ffffff')
        }
      }
      const t = saveToLocal.get('theme')
    
          if (t === 'dark') activateDarkMode()
          else if (t === 'light') activateLightMode()
        
      const asideStatus = saveToLocal.get('aside-status')
      if (asideStatus !== undefined) {
        if (asideStatus === 'hide') {
          document.documentElement.classList.add('hide-aside')
        } else {
          document.documentElement.classList.remove('hide-aside')
        }
      }
    })(window)</script><meta name="generator" content="Hexo 5.4.0"></head><body><div id="sidebar"><div id="menu-mask"></div><div id="sidebar-menus"><div class="author-avatar"><img class="avatar-img" src="/img/pajarnas.jpg" onerror="onerror=null;src='/img/friend_404.gif'" alt="avatar"/></div><div class="site-data"><div class="data-item is-center"><div class="data-item-link"><a href="/archives/"><div class="headline">Articles</div><div class="length-num">36</div></a></div></div><div class="data-item is-center"><div class="data-item-link"><a href="/tags/"><div class="headline">Tags</div><div class="length-num">51</div></a></div></div><div class="data-item is-center"><div class="data-item-link"><a href="/categories/"><div class="headline">Categories</div><div class="length-num">11</div></a></div></div></div><hr/><div class="menus_items"><div class="menus_item"><a class="site-page" href="/"><i class="fa-fw fas fa-home"></i><span> Home</span></a></div><div class="menus_item"><a class="site-page" href="/archives/"><i class="fa-fw fas fa-archive"></i><span> Archives</span></a></div><div class="menus_item"><a class="site-page" href="/tags/"><i class="fa-fw fas fa-tags"></i><span> Tags</span></a></div><div class="menus_item"><a class="site-page" href="/categories/"><i class="fa-fw fas fa-folder-open"></i><span> Categories</span></a></div></div></div></div><div class="post" id="body-wrap"><header class="post-bg" id="page-header" style="background-image: url('https://cdn.jsdelivr.net/npm/butterfly-extsrc@1/img/default.jpg')"><nav id="nav"><span id="blog_name"><a id="site-name" href="/">Saige Blog</a></span><div id="menus"><div class="menus_items"><div class="menus_item"><a class="site-page" href="/"><i class="fa-fw fas fa-home"></i><span> Home</span></a></div><div class="menus_item"><a class="site-page" href="/archives/"><i class="fa-fw fas fa-archive"></i><span> Archives</span></a></div><div class="menus_item"><a class="site-page" href="/tags/"><i class="fa-fw fas fa-tags"></i><span> Tags</span></a></div><div class="menus_item"><a class="site-page" href="/categories/"><i class="fa-fw fas fa-folder-open"></i><span> Categories</span></a></div></div><div id="toggle-menu"><a class="site-page"><i class="fas fa-bars fa-fw"></i></a></div></div></nav><div id="post-info"><h1 class="post-title">ASP Automapper Usage For Entity Framework</h1><div id="post-meta"><div class="meta-firstline"><span class="post-meta-date"><i class="far fa-calendar-alt fa-fw post-meta-icon"></i><span class="post-meta-label">Created</span><time class="post-meta-date-created" datetime="2021-06-16T05:00:00.000Z" title="Created 06-16-2021 00:00:00">06-16-2021</time><span class="post-meta-separator">|</span><i class="fas fa-history fa-fw post-meta-icon"></i><span class="post-meta-label">Updated</span><time class="post-meta-date-updated" datetime="2021-06-19T17:34:02.351Z" title="Updated 06-19-2021 12:34:02">06-19-2021</time></span><span class="post-meta-categories"><span class="post-meta-separator">|</span><i class="fas fa-inbox fa-fw post-meta-icon"></i><a class="post-meta-categories" href="/categories/ASP/">ASP</a></span></div><div class="meta-secondline"><span class="post-meta-separator">|</span><span class="post-meta-pv-cv"><i class="far fa-eye fa-fw post-meta-icon"></i><span class="post-meta-label">Post View:</span><span id="busuanzi_value_page_pv"></span></span></div></div></div></header><main class="layout" id="content-inner"><div id="post"><article class="post-content" id="article-container"><h1 id="Introduction"><a href="#Introduction" class="headerlink" title="Introduction"></a>Introduction</h1><p>Automapper could use user defined mapping profile or built-in mapping. It mapped from the entites(source) to models(desitination). </p>
<h1 id="Code"><a href="#Code" class="headerlink" title="Code"></a>Code</h1><p>MovieDetailResponseModel has two inner class CastResponseModel and GenreResponseModel. The MDRM(MovieDetailResponseModel) has two List property Casts and Genres. We have to define the rules for mapping from Movie Entity’s MovieCast(which has the many-to-many relationship) to MDRM’ Casts. Therefore, we need a method called:</p>
<figure class="highlight plain"><figcaption><span>static List<MovieDetailsResponseModel.CastResponseModel> GetCasts(IEnumerable<MovieCast> srcMovieCasts)```;</span></figcaption><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br></pre></td><td class="code"><pre><span class="line"></span><br><span class="line">By using this method, we can pass Movie Entity&#39;s MovieCast list to this method, then we had a source(rule) for mapped MDRM&#39;s member casts. </span><br><span class="line"></span><br><span class="line">MovieDetailResponseModel:</span><br><span class="line"></span><br><span class="line">&#96;&#96;&#96;c#</span><br><span class="line">public class MovieDetailResponseModel</span><br><span class="line">&#123;</span><br><span class="line">    public int Id &#123; get; set; &#125;</span><br><span class="line">    public string Title &#123; get; set; &#125;</span><br><span class="line">    public string Overview &#123; get; set; &#125;</span><br><span class="line">  </span><br><span class="line">    public IEnumerable&lt;MovieCast&gt; MovieCasts &#123; get; set; &#125;</span><br><span class="line">  </span><br><span class="line">    public IEnumerable&lt;CastResponseModel&gt; Casts &#123; get; set; &#125;</span><br><span class="line">    </span><br><span class="line">    public IEnumerable&lt;GenreResponseModel&gt; Genres &#123; get; set; &#125;</span><br><span class="line">  </span><br><span class="line">    public class CastResponseModel</span><br><span class="line">    &#123;</span><br><span class="line">        public int Id &#123; get; set; &#125;</span><br><span class="line">        public string Name &#123; get; set; &#125;</span><br><span class="line">        public string Gender &#123; get; set; &#125;</span><br><span class="line">        public string TmdbUrl &#123; get; set; &#125;</span><br><span class="line">        public string ProfilePath &#123; get; set; &#125;</span><br><span class="line">        public string Character &#123; get; set; &#125;</span><br><span class="line">    &#125;</span><br><span class="line">    </span><br><span class="line">    public class GenreResponseModel</span><br><span class="line">    &#123;</span><br><span class="line">        public int Id &#123; get; set; &#125;</span><br><span class="line">        public string Name &#123; get; set; &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>Movie Entity class:</p>
<figure class="highlight c#"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title">Movie</span></span><br><span class="line">   &#123;</span><br><span class="line">       <span class="keyword">public</span> <span class="built_in">int</span> Id &#123; <span class="keyword">get</span>; <span class="keyword">set</span>; &#125;</span><br><span class="line">       <span class="keyword">public</span> <span class="built_in">string</span> Title &#123; <span class="keyword">get</span>; <span class="keyword">set</span>; &#125;</span><br><span class="line">       <span class="keyword">public</span> <span class="built_in">string</span> Overview &#123; <span class="keyword">get</span>; <span class="keyword">set</span>; &#125;</span><br><span class="line">     </span><br><span class="line">       <span class="keyword">public</span> ICollection&lt;Trailer&gt; Trailers &#123; <span class="keyword">get</span>; <span class="keyword">set</span>; &#125;</span><br><span class="line">       <span class="keyword">public</span> ICollection&lt;Review&gt; Reviews &#123; <span class="keyword">get</span>; <span class="keyword">set</span>; &#125;</span><br><span class="line">       <span class="keyword">public</span> ICollection&lt;MovieCast&gt; MovieCasts &#123; <span class="keyword">get</span>; <span class="keyword">set</span>; &#125;</span><br><span class="line">       <span class="keyword">public</span> ICollection&lt;MovieGenre&gt; MovieGenres &#123; <span class="keyword">get</span>; <span class="keyword">set</span>; &#125;</span><br><span class="line">       <span class="keyword">public</span> ICollection&lt;MovieCrew&gt; MovieCrews &#123; <span class="keyword">get</span>; <span class="keyword">set</span>; &#125;</span><br><span class="line">       <span class="keyword">public</span> ICollection&lt;Purchase&gt; Purchases &#123; <span class="keyword">get</span>; <span class="keyword">set</span>; &#125;</span><br><span class="line">       <span class="keyword">public</span> ICollection&lt;Favorite&gt; Favorites &#123; <span class="keyword">get</span>; <span class="keyword">set</span>; &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>GetCasts Method:</p>
<figure class="highlight c#"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">private</span> <span class="keyword">static</span> List&lt;MovieDetailResponseModel.CastResponseModel&gt; GetCasts(IEnumerable&lt;MovieCast&gt; srcMovieCasts)</span><br><span class="line">       &#123;</span><br><span class="line">           <span class="keyword">var</span> movieCast = <span class="keyword">new</span> List&lt;MovieDetailsResponseModel.CastResponseModel&gt;();</span><br><span class="line">           <span class="keyword">foreach</span> (<span class="keyword">var</span> cast <span class="keyword">in</span> srcMovieCasts)</span><br><span class="line">               movieCast.Add(<span class="keyword">new</span> MovieDetailsResponseModel.CastResponseModel</span><br><span class="line">               &#123;</span><br><span class="line">                   Id = cast.CastId,</span><br><span class="line">                   Gender = cast.Cast.Gender,</span><br><span class="line">                   Name = cast.Cast.Name,</span><br><span class="line">                   ProfilePath = cast.Cast.ProfilePath,</span><br><span class="line">                   TmdbUrl = cast.Cast.TmdbUrl,</span><br><span class="line">                   Character = cast.Character</span><br><span class="line">               &#125;);</span><br><span class="line"></span><br><span class="line">           <span class="keyword">return</span> movieCast;</span><br><span class="line">       &#125;</span><br></pre></td></tr></table></figure>

<p>In the same way, we can configure MDRM’s genres.</p>
<p>Since we have the same property name between MDRM and Movie Entity, we can simply use built-in method:</p>
<figure class="highlight c#"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">CreateMap&lt;Movie, MovieDetailsResponseModel&gt;()</span><br><span class="line"><span class="comment">// only for the same simple property </span></span><br></pre></td></tr></table></figure>

<p>Now, we put it together as a MappingProfile class:</p>
<figure class="highlight c#"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title">MovieShopMappingProfile</span> : <span class="title">Profile</span></span><br><span class="line">    &#123;</span><br><span class="line">        <span class="function"><span class="keyword">public</span> <span class="title">MovieShopMappingProfile</span>(<span class="params"></span>)</span></span><br><span class="line"><span class="function"></span>        &#123;</span><br><span class="line">            </span><br><span class="line">            CreateMap&lt;Movie, MovieDetailsResponseModel&gt;()</span><br><span class="line">                .ForMember(md =&gt; md.Casts, opt =&gt; opt.MapFrom(src =&gt; GetCasts(src.MovieCasts)))</span><br><span class="line">                .ForMember(md =&gt; md.Genres, opt =&gt; opt.MapFrom(src =&gt; GetGenres(src.MovieGenres)));</span><br><span class="line">				&#125;</span><br><span class="line">				</span><br><span class="line">				<span class="keyword">private</span> <span class="keyword">static</span> List&lt;MovieDetailsResponseModel.CastResponseModel&gt; GetCasts(IEnumerable&lt;MovieCast&gt; srcMovieCasts)</span><br><span class="line">        &#123;</span><br><span class="line">            <span class="keyword">var</span> movieCast = <span class="keyword">new</span> List&lt;MovieDetailsResponseModel.CastResponseModel&gt;();</span><br><span class="line">            <span class="keyword">foreach</span> (<span class="keyword">var</span> cast <span class="keyword">in</span> srcMovieCasts)</span><br><span class="line">                movieCast.Add(<span class="keyword">new</span> MovieDetailsResponseModel.CastResponseModel</span><br><span class="line">                &#123;</span><br><span class="line">                    Id = cast.CastId,</span><br><span class="line">                    Gender = cast.Cast.Gender,</span><br><span class="line">                    Name = cast.Cast.Name,</span><br><span class="line">                    ProfilePath = cast.Cast.ProfilePath,</span><br><span class="line">                    TmdbUrl = cast.Cast.TmdbUrl,</span><br><span class="line">                    Character = cast.Character</span><br><span class="line">                &#125;);</span><br><span class="line"></span><br><span class="line">            <span class="keyword">return</span> movieCast;</span><br><span class="line">        &#125;</span><br><span class="line">        </span><br><span class="line">        <span class="keyword">private</span> <span class="keyword">static</span> List&lt;MovieDetailResponseModel.GenreResponseModel&gt; GetGenres(IEnumerable&lt;MovieGenre&gt; srcMovieGenres)</span><br><span class="line">        &#123;</span><br><span class="line">            <span class="keyword">var</span> movieGenres = <span class="keyword">new</span> List&lt;MovieDetailResponseModel.GenreResponseModel&gt;();</span><br><span class="line">            <span class="keyword">foreach</span> (<span class="keyword">var</span> genre <span class="keyword">in</span> srcMovieGenres)</span><br><span class="line">                movieGenres.Add(<span class="keyword">new</span> MovieDetailResponseModel.GenreResponseModel</span><br><span class="line">                &#123;</span><br><span class="line">                    Id = genre.GenreId,</span><br><span class="line">                   </span><br><span class="line">                    Name = genre.Genre.Name,</span><br><span class="line">                    </span><br><span class="line">                &#125;);</span><br><span class="line"></span><br><span class="line">            <span class="keyword">return</span> movieGenres;</span><br><span class="line">        &#125;</span><br><span class="line">         </span><br><span class="line">    &#125;</span><br><span class="line">    </span><br></pre></td></tr></table></figure>





<p>Define paginated list inhered from <strong>List</strong>, having the property <strong>PageIndex</strong> (The page number) ,<strong>TotalPages</strong> (Count/pageSize), <em><strong>TotalCount</strong></em>(total item count), this one is not necessary becuase the count is accessible from <code>List.Count</code> Therefore, in order to get the next page, you need to send the next pageIndex to controller(PageIndex + 1). The page size is set to 30 by default. The page size is option parameter for controller. The GetPaged method is a static method to get paged list by <strong>skipping</strong> the number of page number. </p>
<figure class="highlight c#"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title">PaginatedList</span>&lt;<span class="title">T</span>&gt; : <span class="title">List</span>&lt;<span class="title">T</span>&gt; <span class="keyword">where</span> <span class="title">T</span>: <span class="keyword">class</span></span><br><span class="line">    &#123;</span><br><span class="line">        <span class="function"><span class="keyword">public</span> <span class="title">PaginatedList</span>(<span class="params">List&lt;T&gt; items, <span class="built_in">int</span> count, <span class="built_in">int</span> page, <span class="built_in">int</span> pageSize</span>)</span></span><br><span class="line"><span class="function"></span>        &#123;</span><br><span class="line">            PageIndex = page;</span><br><span class="line">            TotalPages = (<span class="built_in">int</span>) Math.Ceiling(count / (<span class="built_in">double</span>) pageSize);</span><br><span class="line">            TotalCount = count;</span><br><span class="line">            AddRange(items);</span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">        <span class="function"><span class="keyword">public</span> <span class="title">PaginatedList</span>(<span class="params"></span>)</span></span><br><span class="line"><span class="function"></span>        &#123;</span><br><span class="line">            </span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">public</span> <span class="built_in">int</span> PageIndex &#123; <span class="keyword">get</span>; <span class="keyword">set</span>; &#125;</span><br><span class="line">        <span class="keyword">public</span> <span class="built_in">int</span> TotalPages &#123; <span class="keyword">get</span>; <span class="keyword">set</span>; &#125;</span><br><span class="line">        <span class="keyword">public</span> <span class="built_in">int</span> TotalCount &#123; <span class="keyword">get</span>; <span class="keyword">set</span>; &#125;</span><br><span class="line">        <span class="keyword">public</span> <span class="built_in">bool</span> HasPreviousPage =&gt; PageIndex &gt; <span class="number">1</span>;</span><br><span class="line">        <span class="keyword">public</span> <span class="built_in">bool</span> HasNextPage =&gt; PageIndex &lt; TotalPages;</span><br><span class="line"></span><br><span class="line">        <span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">async</span> Task&lt;PaginatedList&lt;T&gt;&gt; GetPaged(</span><br><span class="line">            IQueryable&lt;T&gt; source, <span class="built_in">int</span> pageIndex, <span class="built_in">int</span> pageSize,</span><br><span class="line">            Func&lt;IQueryable&lt;T&gt;, IOrderedQueryable&lt;T&gt;&gt; orderedQuery = <span class="literal">null</span>,</span><br><span class="line">            Expression&lt;Func&lt;T, <span class="built_in">bool</span>&gt;&gt; filter = <span class="literal">null</span>, </span><br><span class="line">            <span class="keyword">params</span> Expression&lt;Func&lt;T, <span class="built_in">object</span>&gt;&gt;[] includes)</span><br><span class="line">        &#123;</span><br><span class="line">            <span class="comment">// source query which implemented IQuerable</span></span><br><span class="line">            <span class="keyword">var</span> query = source;</span><br><span class="line">            </span><br><span class="line">            <span class="comment">// A expression tree accepts a lambda expression</span></span><br><span class="line">            <span class="keyword">if</span> (filter != <span class="literal">null</span>) query = query.Where(filter);</span><br><span class="line">            </span><br><span class="line">            <span class="comment">// orderedQuery is a delegate that accept a IQueryable as parameter and outputs IOrderedQueryable.</span></span><br><span class="line">            <span class="comment">// In this example, query is a parameter, executes the lambda expression function</span></span><br><span class="line">           <span class="comment">// orderQuery = rev =&gt; rev.OrderByDescending(r =&gt; r.Rating)</span></span><br><span class="line">            <span class="keyword">if</span> (orderedQuery != <span class="literal">null</span>) query = orderedQuery(query);</span><br><span class="line">            </span><br><span class="line">            <span class="comment">//Assign Lambda expressions Includes to Expression Tree</span></span><br><span class="line">            <span class="keyword">if</span> (includes != <span class="literal">null</span>)</span><br><span class="line">                <span class="keyword">foreach</span> (Expression&lt;Func&lt;T, <span class="built_in">object</span>&gt;&gt; navigationProperty <span class="keyword">in</span> includes)</span><br><span class="line">                    query = query.Include(navigationProperty);</span><br><span class="line"></span><br><span class="line">            <span class="keyword">var</span> count = <span class="keyword">await</span> query.CountAsync();</span><br><span class="line">            <span class="keyword">var</span> items = <span class="keyword">await</span> query.Skip((pageIndex - <span class="number">1</span>) * pageSize).Take(pageSize).ToListAsync();</span><br><span class="line">            <span class="keyword">return</span> <span class="keyword">new</span> PaginatedList&lt;T&gt;(items, count, pageIndex, pageSize);</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br></pre></td></tr></table></figure>

<p>The PagedResultSet is a simplfied class to store IEnumberables, I don’t know the other use, let me know if you had some ideas. </p>
<figure class="highlight c#"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title">PagedResultSet</span>&lt;<span class="title">TEntity</span>&gt; <span class="keyword">where</span> <span class="title">TEntity</span> : <span class="keyword">class</span></span><br><span class="line">    &#123;</span><br><span class="line">        <span class="function"><span class="keyword">public</span> <span class="title">PagedResultSet</span>(<span class="params">IEnumerable&lt;TEntity&gt; data, <span class="built_in">int</span> pageIndex, <span class="built_in">int</span> pageSize, <span class="built_in">int</span> count</span>)</span></span><br><span class="line"><span class="function"></span>        &#123;</span><br><span class="line">            PageIndex = pageIndex;</span><br><span class="line">            PageSize = pageSize;</span><br><span class="line">            Count = count;</span><br><span class="line">            Data = data;</span><br><span class="line">            TotalPages = (<span class="built_in">int</span>) Math.Ceiling(count / (<span class="built_in">double</span>) pageSize);</span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">        <span class="keyword">public</span> <span class="built_in">int</span> PageIndex &#123; <span class="keyword">get</span>; &#125;</span><br><span class="line">        <span class="keyword">public</span> <span class="built_in">int</span> PageSize &#123; <span class="keyword">get</span>; &#125;</span><br><span class="line">        <span class="keyword">public</span> <span class="built_in">int</span> TotalPages &#123; <span class="keyword">get</span>; &#125;</span><br><span class="line">        <span class="keyword">public</span> <span class="built_in">long</span> Count &#123; <span class="keyword">get</span>; &#125;</span><br><span class="line">        <span class="keyword">public</span> IEnumerable&lt;TEntity&gt; Data &#123; <span class="keyword">get</span>; &#125;</span><br><span class="line">    &#125;</span><br></pre></td></tr></table></figure>

<p>Every Repository should implement the GetPagedData method, which is simply invoke the PaginatedList’s static method with parameters, page, pageSize, orderedQuery, filter, includes. </p>
<figure class="highlight c#"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="keyword">interface</span> <span class="title">IAsyncRepository</span>&lt;<span class="title">T</span>&gt; <span class="keyword">where</span> <span class="title">T</span> : <span class="keyword">class</span></span><br><span class="line">    &#123;</span><br><span class="line">        ...</span><br><span class="line">        </span><br><span class="line">            Task&lt;PaginatedList&lt;T&gt;&gt; GetPagedData(<span class="built_in">int</span> pageIndex, <span class="built_in">int</span> pageSize, Func&lt;IQueryable&lt;T&gt;, IOrderedQueryable&lt;T&gt;&gt; orderedQuery = <span class="literal">null</span>, Expression&lt;Func&lt;T, <span class="built_in">bool</span>&gt;&gt; filter = <span class="literal">null</span>, <span class="keyword">params</span> Expression&lt;Func&lt;T, <span class="built_in">object</span>&gt;&gt;[] includes);</span><br><span class="line">    &#125;</span><br></pre></td></tr></table></figure>

<p> GetPagedData Method requires no source since EfRepository class has DbContext for entity class T</p>
<p>The base Repository class:</p>
<figure class="highlight c#"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title">EfRepository</span>&lt;<span class="title">T</span>&gt; : <span class="title">IAsyncRepository</span>&lt;<span class="title">T</span>&gt; <span class="keyword">where</span> <span class="title">T</span> : <span class="keyword">class</span></span><br><span class="line">    &#123;</span><br><span class="line">        <span class="keyword">protected</span> <span class="keyword">readonly</span> MovieShopDbContext _dbContext;</span><br><span class="line"></span><br><span class="line">        <span class="function"><span class="keyword">public</span> <span class="title">EfRepository</span>(<span class="params">MovieShopDbContext dbContext</span>)</span></span><br><span class="line"><span class="function"></span>        &#123;</span><br><span class="line">            _dbContext = dbContext;</span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">        <span class="keyword">public</span> <span class="keyword">virtual</span> <span class="keyword">async</span> Task&lt;PaginatedList&lt;T&gt;&gt; GetPagedData(<span class="built_in">int</span> page = <span class="number">1</span>, <span class="built_in">int</span> pageSize = <span class="number">25</span>,</span><br><span class="line">            Func&lt;IQueryable&lt;T&gt;, IOrderedQueryable&lt;T&gt;&gt; orderedQuery</span><br><span class="line">                = <span class="literal">null</span>, Expression&lt;Func&lt;T, <span class="built_in">bool</span>&gt;&gt; filter = <span class="literal">null</span>, <span class="keyword">params</span> Expression&lt;Func&lt;T, <span class="built_in">object</span>&gt;&gt;[] includes)</span><br><span class="line">        &#123;</span><br><span class="line">            <span class="keyword">var</span> pagedList =</span><br><span class="line">                <span class="keyword">await</span> PaginatedList&lt;T&gt;.GetPaged(_dbContext.Set&lt;T&gt;(), page, pageSize, orderedQuery, filter, includes);</span><br><span class="line">            <span class="keyword">return</span> pagedList;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br></pre></td></tr></table></figure>

<p>The service’s class gets different paged result sets based on the bussiness logic. </p>
<figure class="highlight c#"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="keyword">interface</span> <span class="title">IMovieService</span></span><br><span class="line"> &#123;</span><br><span class="line">     Task&lt;PagedResultSet&lt;MovieResponseModel&gt;&gt; GetMoviesByPagination(<span class="built_in">int</span> pageSize = <span class="number">20</span>, <span class="built_in">int</span> page = <span class="number">1</span>, <span class="built_in">string</span> title = <span class="string">&quot;&quot;</span>);</span><br><span class="line">     Task&lt;PagedResultSet&lt;MovieResponseModel&gt;&gt; GetAllMoviePurchasesByPagination(<span class="built_in">int</span> pageSize = <span class="number">20</span>, <span class="built_in">int</span> page = <span class="number">1</span>);</span><br><span class="line">     Task&lt;PagedResultSet&lt;MovieResponseModel&gt;&gt; GetAllPurchasesByMovieId(<span class="built_in">int</span> movieId);</span><br><span class="line">     Task&lt;PaginatedList&lt;MovieResponseModel&gt;&gt; GetMoviesByGenre(<span class="built_in">int</span> genreId, <span class="built_in">int</span> pageSize = <span class="number">25</span>, <span class="built_in">int</span> page = <span class="number">1</span>);</span><br><span class="line">     ...</span><br><span class="line"> &#125;</span><br></pre></td></tr></table></figure>

<ul>
<li><p>The <code>mov =&gt; mov.OrderBy(m =&gt; m.Title)</code> assigned <code>IOrderedQueryable&lt;T&gt; orderedQuery = null</code></p>
</li>
<li><p> <code>if (!string.IsNullOrEmpty(title)) filterExpression = movie =&gt; title != null &amp;&amp; movie.Title.Contains(title);</code> if the title is not null or empty, assigned <code>Expression&lt;Func&lt;T, bool&gt;&gt; filter = null</code> with filterExpression. </p>
</li>
</ul>
<p>  For the example,<code>_reviewRepository.GetPagedData(1, 25, rev =&gt; rev.OrderByDescending(r =&gt; r.Rating), filterExpression, review =&gt; review.Movie);</code> <code>review =&gt; review.Movie</code> is a Include expression tree having delegate Func&lt;T,object&gt; to let <code>DbSet\&lt;Review\&gt;().Include(Func&lt;T,object&gt;)</code>.</p>
<p>  <em>See C# Core I: LINQ for definition of ExpressionTree</em></p>
<figure class="highlight c#"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title">MovieService</span> : <span class="title">IMovieService</span></span><br><span class="line">   &#123;</span><br><span class="line">       <span class="keyword">private</span> <span class="keyword">readonly</span> IAsyncRepository&lt;Favorite&gt; _favoriteRepository;</span><br><span class="line">       <span class="keyword">private</span> <span class="keyword">readonly</span> IAsyncRepository&lt;Genre&gt; _genreRepository;</span><br><span class="line">       <span class="keyword">private</span> <span class="keyword">readonly</span> IMapper _mapper;</span><br><span class="line">       <span class="keyword">private</span> <span class="keyword">readonly</span> IMovieRepository _movieRepository;</span><br><span class="line">       <span class="keyword">private</span> <span class="keyword">readonly</span> IPurchaseRepository _purchaseRepository;</span><br><span class="line">       <span class="keyword">private</span> <span class="keyword">readonly</span> IAsyncRepository&lt;Review&gt; _reviewRepository;</span><br><span class="line"></span><br><span class="line">       <span class="function"><span class="keyword">public</span> <span class="title">MovieService</span>(<span class="params">IMovieRepository movieRepository, IMapper mapper, IPurchaseRepository purchaseRepository,</span></span></span><br><span class="line"><span class="function"><span class="params">           IAsyncRepository&lt;Favorite&gt; favoriteRepository, IAsyncRepository&lt;Review&gt; reviewRepository,</span></span></span><br><span class="line"><span class="function"><span class="params">           IAsyncRepository&lt;Genre&gt; genreRepository</span>)</span></span><br><span class="line"><span class="function"></span>       &#123;</span><br><span class="line">           _movieRepository = movieRepository;</span><br><span class="line">           _mapper = mapper;</span><br><span class="line">           _purchaseRepository = purchaseRepository;</span><br><span class="line">           _favoriteRepository = favoriteRepository;</span><br><span class="line">           _reviewRepository = reviewRepository;</span><br><span class="line">           _genreRepository = genreRepository;</span><br><span class="line">       &#125;</span><br><span class="line"></span><br><span class="line">       <span class="keyword">public</span> <span class="keyword">async</span> Task&lt;PagedResultSet&lt;MovieResponseModel&gt;&gt; GetMoviesByPagination(</span><br><span class="line">           <span class="built_in">int</span> pageSize = <span class="number">20</span>, <span class="built_in">int</span> pageIndex = <span class="number">0</span>, <span class="built_in">string</span> title = <span class="string">&quot;&quot;</span>)</span><br><span class="line">       &#123;</span><br><span class="line">           Expression&lt;Func&lt;Movie, <span class="built_in">bool</span>&gt;&gt; filterExpression = <span class="literal">null</span>;</span><br><span class="line">           <span class="keyword">if</span> (!<span class="built_in">string</span>.IsNullOrEmpty(title)) filterExpression = movie =&gt; title != <span class="literal">null</span> &amp;&amp; movie.Title.Contains(title);</span><br><span class="line"></span><br><span class="line">           <span class="keyword">var</span> pagedMovies = <span class="keyword">await</span> _movieRepository.GetPagedData(pageIndex, pageSize, mov =&gt; mov.OrderBy(m =&gt; m.Title),</span><br><span class="line">               filterExpression);</span><br><span class="line">           <span class="keyword">var</span> movies =</span><br><span class="line">               <span class="keyword">new</span> PagedResultSet&lt;MovieResponseModel&gt;(_mapper.Map&lt;List&lt;MovieResponseModel&gt;&gt;(pagedMovies),</span><br><span class="line">                   pagedMovies.PageIndex,</span><br><span class="line">                   pageSize, pagedMovies.TotalCount);</span><br><span class="line">           <span class="keyword">return</span> movies;</span><br><span class="line">       &#125;</span><br><span class="line"></span><br><span class="line">       <span class="keyword">public</span> <span class="keyword">async</span> Task&lt;PagedResultSet&lt;MovieResponseModel&gt;&gt; GetAllMoviePurchasesByPagination(<span class="built_in">int</span> pageSize = <span class="number">50</span>,</span><br><span class="line">           <span class="built_in">int</span> page = <span class="number">0</span>)</span><br><span class="line">       &#123;</span><br><span class="line">           <span class="keyword">var</span> totalPurchases = <span class="keyword">await</span> _purchaseRepository.GetCountAsync();</span><br><span class="line">           <span class="keyword">var</span> purchases = <span class="keyword">await</span> _purchaseRepository.GetAllPurchases(pageSize, page);</span><br><span class="line"></span><br><span class="line">           <span class="keyword">var</span> data = _mapper.Map&lt;List&lt;MovieResponseModel&gt;&gt;(purchases);</span><br><span class="line">           <span class="keyword">var</span> purchasedMovies = <span class="keyword">new</span> PagedResultSet&lt;MovieResponseModel&gt;(data, page, pageSize, totalPurchases);</span><br><span class="line">           <span class="keyword">return</span> purchasedMovies;</span><br><span class="line">       &#125;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">       <span class="keyword">public</span> <span class="keyword">async</span> Task&lt;PaginatedList&lt;MovieResponseModel&gt;&gt; GetMoviesByGenre(<span class="built_in">int</span> genreId, <span class="built_in">int</span> pageSize = <span class="number">30</span>,</span><br><span class="line">           <span class="built_in">int</span> page = <span class="number">1</span>)</span><br><span class="line">       &#123;</span><br><span class="line">           <span class="keyword">var</span> pagedMovies = <span class="keyword">await</span> _movieRepository.GetMoviesByGenre(genreId, pageSize, page);</span><br><span class="line">           <span class="keyword">var</span> data = _mapper.Map&lt;PaginatedList&lt;MovieResponseModel&gt;&gt;(pagedMovies);</span><br><span class="line">           <span class="keyword">var</span> movies = <span class="keyword">new</span> PaginatedList&lt;MovieResponseModel&gt;(data, pagedMovies.TotalCount, page, pageSize);</span><br><span class="line">           <span class="keyword">return</span> movies;</span><br><span class="line">       &#125;</span><br><span class="line"></span><br><span class="line">       <span class="function"><span class="keyword">public</span> <span class="keyword">async</span> Task&lt;MovieDetailsResponseModel&gt; <span class="title">GetMovieAsync</span>(<span class="params"><span class="built_in">int</span> id</span>)</span></span><br><span class="line"><span class="function"></span>       &#123;</span><br><span class="line">           <span class="keyword">var</span> movie = <span class="keyword">await</span> _movieRepository.GetByIdAsync(id);</span><br><span class="line">           <span class="keyword">if</span> (movie == <span class="literal">null</span>) <span class="keyword">throw</span> <span class="keyword">new</span> NotFoundException(<span class="string">&quot;Movie&quot;</span>, id);</span><br><span class="line">           <span class="keyword">var</span> favoritesCount = <span class="keyword">await</span> _favoriteRepository.GetCountAsync(f =&gt; f.MovieId == id);</span><br><span class="line">           <span class="keyword">var</span> response = _mapper.Map&lt;MovieDetailsResponseModel&gt;(movie);</span><br><span class="line">           response.FavoritesCount = favoritesCount;</span><br><span class="line">           <span class="keyword">return</span> response;</span><br><span class="line">       &#125;</span><br><span class="line"></span><br><span class="line">       <span class="keyword">public</span> <span class="keyword">async</span> Task&lt;IEnumerable&lt;ReviewMovieResponseModel&gt;&gt; GetReviewsForMovie(<span class="built_in">int</span> id)</span><br><span class="line">       &#123;</span><br><span class="line">           Expression&lt;Func&lt;Review, <span class="built_in">bool</span>&gt;&gt; filterExpression = review =&gt; review.MovieId == id;</span><br><span class="line"></span><br><span class="line">           <span class="keyword">var</span> reviews = <span class="keyword">await</span> _reviewRepository.GetPagedData(<span class="number">1</span>, <span class="number">25</span>, rev =&gt; rev.OrderByDescending(r =&gt; r.Rating),</span><br><span class="line">               filterExpression, review =&gt; review.Movie);</span><br><span class="line"></span><br><span class="line">           <span class="keyword">var</span> response = _mapper.Map&lt;IEnumerable&lt;ReviewMovieResponseModel&gt;&gt;(reviews);</span><br><span class="line">           <span class="keyword">return</span> response;</span><br><span class="line">       &#125;</span><br><span class="line"></span><br><span class="line">       <span class="function"><span class="keyword">public</span> <span class="keyword">async</span> Task&lt;<span class="built_in">int</span>&gt; <span class="title">GetMoviesCount</span>(<span class="params"><span class="built_in">string</span> title = <span class="string">&quot;&quot;</span></span>)</span></span><br><span class="line"><span class="function"></span>       &#123;</span><br><span class="line">           <span class="keyword">if</span> (<span class="built_in">string</span>.IsNullOrEmpty(title)) <span class="keyword">return</span> <span class="keyword">await</span> _movieRepository.GetCountAsync();</span><br><span class="line">           <span class="keyword">return</span> <span class="keyword">await</span> _movieRepository.GetCountAsync(m =&gt; m.Title.Contains(title));</span><br><span class="line">       &#125;</span><br><span class="line"></span><br><span class="line">   &#125;</span><br></pre></td></tr></table></figure>

<p>The controller acquires the PagedList from services then assign it to the View.</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line">public class HomeController : Controller</span><br><span class="line">   &#123;</span><br><span class="line">       private readonly ILogger&lt;HomeController&gt; _logger;</span><br><span class="line">       private readonly IMovieService _movieService;</span><br><span class="line"></span><br><span class="line">       public HomeController(ILogger&lt;HomeController&gt; logger, IMovieService movieService)</span><br><span class="line">       &#123;</span><br><span class="line">           _logger &#x3D; logger;</span><br><span class="line">           _movieService &#x3D; movieService;</span><br><span class="line">       &#125;</span><br><span class="line"></span><br><span class="line">       public async Task&lt;IActionResult&gt; Genre(int id, int pageSize &#x3D; 30, int pageNumber &#x3D; 1)</span><br><span class="line">       &#123;</span><br><span class="line">           var movies &#x3D; await _movieService.GetMoviesByGenre(id, pageSize, pageNumber);</span><br><span class="line">           return View(&quot;PagedIndex&quot;, movies);</span><br><span class="line">       &#125;</span><br><span class="line">   &#125;</span><br></pre></td></tr></table></figure>

<p>In PagedIndex.cshtml: </p>
<figure class="highlight plain"><figcaption><span>is sent to the controller and the parameter name controller receives should be pageNumber by convention i guess? Correct me if i am wrong.</span></figcaption><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"></span><br><span class="line">&#96;&#96;&#96;@&#123;</span><br><span class="line">    var prevDisabled &#x3D; !Model.HasPreviousPage ? &quot;disabled&quot; : &quot;&quot;;</span><br><span class="line">    var nextDisabled &#x3D; !Model.HasNextPage ? &quot;disabled&quot; : &quot;&quot;;</span><br><span class="line">    ...</span><br><span class="line">    &lt;a asp-action&#x3D;&quot;Genre&quot; asp-route-pageNumber&#x3D;&quot;@(Model.PageIndex - 1)&quot; class&#x3D;&quot;btn btn-primary @prevDisabled&quot;&gt; </span><br><span class="line">            Previous</span><br><span class="line">    &lt;&#x2F;a&gt;</span><br></pre></td></tr></table></figure>

<figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br></pre></td><td class="code"><pre><span class="line">@model ApplicationCore.Helpers.PaginatedList<span class="tag">&lt;<span class="name">ApplicationCore.Models.MovieResponseModel</span>&gt;</span></span><br><span class="line"></span><br><span class="line"><span class="tag">&lt;<span class="name">div</span> <span class="attr">class</span>=<span class="string">&quot;rounded&quot;</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">div</span> <span class="attr">class</span>=<span class="string">&quot;container-fluid bg-light&quot;</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">div</span> <span class="attr">class</span>=<span class="string">&quot;row&quot;</span>&gt;</span></span><br><span class="line">            @foreach (var movie in Model)</span><br><span class="line">            &#123;</span><br><span class="line">                <span class="tag">&lt;<span class="name">div</span> <span class="attr">class</span>=<span class="string">&quot;col-6 col-lg-3 col-sm-4 col-xl-2&quot;</span>&gt;</span></span><br><span class="line">                    @*<span class="tag">&lt;<span class="name">partial</span> <span class="attr">name</span>=<span class="string">&quot;MovieCard&quot;</span> <span class="attr">model</span>=<span class="string">&quot;movie&quot;</span>/&gt;</span>*@</span><br><span class="line">                    @await Html.PartialAsync(&quot;_MovieCard&quot;, movie)</span><br><span class="line">                <span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br><span class="line">            &#125;</span><br><span class="line">        <span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br><span class="line"></span><br><span class="line">@&#123;</span><br><span class="line">    var prevDisabled = !Model.HasPreviousPage ? &quot;disabled&quot; : &quot;&quot;;</span><br><span class="line">    var nextDisabled = !Model.HasNextPage ? &quot;disabled&quot; : &quot;&quot;;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="tag">&lt;<span class="name">a</span> <span class="attr">asp-action</span>=<span class="string">&quot;Genre&quot;</span></span></span><br><span class="line"><span class="tag">   <span class="attr">asp-route-pageNumber</span>=<span class="string">&quot;@(Model.PageIndex - 1)&quot;</span></span></span><br><span class="line"><span class="tag">   <span class="attr">class</span>=<span class="string">&quot;btn btn-primary @prevDisabled&quot;</span>&gt;</span></span><br><span class="line">    Previous</span><br><span class="line"><span class="tag">&lt;/<span class="name">a</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">a</span> <span class="attr">asp-action</span>=<span class="string">&quot;Genre&quot;</span></span></span><br><span class="line"><span class="tag">   <span class="attr">asp-route-pageNumber</span>=<span class="string">&quot;@(Model.PageIndex + 1)&quot;</span></span></span><br><span class="line"><span class="tag">   <span class="attr">class</span>=<span class="string">&quot;btn btn-primary @nextDisabled&quot;</span>&gt;</span></span><br><span class="line">    Next</span><br><span class="line"><span class="tag">&lt;/<span class="name">a</span>&gt;</span></span><br></pre></td></tr></table></figure>

<h1 id="Another-Automapper-Example"><a href="#Another-Automapper-Example" class="headerlink" title="Another Automapper Example"></a>Another Automapper Example</h1><figure class="highlight c#"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br><span class="line">120</span><br><span class="line">121</span><br><span class="line">122</span><br><span class="line">123</span><br><span class="line">124</span><br><span class="line">125</span><br><span class="line">126</span><br><span class="line">127</span><br><span class="line">128</span><br><span class="line">129</span><br><span class="line">130</span><br><span class="line">131</span><br><span class="line">132</span><br><span class="line">133</span><br><span class="line">134</span><br><span class="line">135</span><br><span class="line">136</span><br><span class="line">137</span><br><span class="line">138</span><br><span class="line">139</span><br><span class="line">140</span><br><span class="line">141</span><br><span class="line">142</span><br><span class="line">143</span><br><span class="line">144</span><br><span class="line">145</span><br><span class="line">146</span><br><span class="line">147</span><br><span class="line">148</span><br><span class="line">149</span><br><span class="line">150</span><br><span class="line">151</span><br><span class="line">152</span><br></pre></td><td class="code"><pre><span class="line"></span><br><span class="line"><span class="comment">//Movie.cs</span></span><br><span class="line"> <span class="keyword">public</span> <span class="keyword">class</span> <span class="title">Movie</span></span><br><span class="line">    &#123;</span><br><span class="line">        <span class="keyword">public</span> <span class="built_in">int</span> Id &#123; <span class="keyword">get</span>; <span class="keyword">set</span>; &#125;</span><br><span class="line">        <span class="keyword">public</span> <span class="built_in">string</span> Title &#123; <span class="keyword">get</span>; <span class="keyword">set</span>; &#125;</span><br><span class="line">        <span class="keyword">public</span> <span class="built_in">string</span> Overview &#123; <span class="keyword">get</span>; <span class="keyword">set</span>; &#125;</span><br><span class="line">        ...</span><br><span class="line">          </span><br><span class="line">        <span class="keyword">public</span> IEnumerable&lt;MovieCast&gt; MovieCasts &#123; <span class="keyword">get</span>; <span class="keyword">set</span>; &#125;</span><br><span class="line">        <span class="keyword">public</span> IEnumerable&lt;MovieGenre&gt; MovieGenres &#123; <span class="keyword">get</span>; <span class="keyword">set</span>; &#125;</span><br><span class="line">   </span><br><span class="line"></span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">//MovieCast.cs</span></span><br><span class="line">  <span class="keyword">public</span> <span class="keyword">class</span> <span class="title">MovieCast</span></span><br><span class="line">    &#123;</span><br><span class="line">        <span class="keyword">public</span> <span class="built_in">int</span> MovieId &#123; <span class="keyword">get</span>; <span class="keyword">set</span>; &#125;</span><br><span class="line">        <span class="keyword">public</span> <span class="built_in">int</span> CastId &#123; <span class="keyword">get</span>; <span class="keyword">set</span>; &#125;</span><br><span class="line">        <span class="keyword">public</span> <span class="built_in">string</span> Character &#123; <span class="keyword">get</span>; <span class="keyword">set</span>; &#125;</span><br><span class="line">        <span class="keyword">public</span> Cast Cast &#123; <span class="keyword">get</span>; <span class="keyword">set</span>; &#125;</span><br><span class="line">        <span class="keyword">public</span> Movie Movie &#123; <span class="keyword">get</span>; <span class="keyword">set</span>; &#125;</span><br><span class="line">       </span><br><span class="line">    &#125;</span><br><span class="line"><span class="comment">//MovieGenre.cs</span></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">class</span> <span class="title">MovieGenre</span></span><br><span class="line">    &#123;</span><br><span class="line">        <span class="keyword">public</span> <span class="built_in">int</span> MovieId &#123; <span class="keyword">get</span>; <span class="keyword">set</span>; &#125;</span><br><span class="line">        <span class="keyword">public</span> <span class="built_in">int</span> GenreId &#123; <span class="keyword">get</span>; <span class="keyword">set</span>; &#125;</span><br><span class="line"></span><br><span class="line">        <span class="keyword">public</span> Movie Movie &#123; <span class="keyword">get</span>; <span class="keyword">set</span>; &#125;</span><br><span class="line">        <span class="keyword">public</span> Genre Genre &#123; <span class="keyword">get</span>; <span class="keyword">set</span>; &#125;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="comment">//MovieDetailResponseModel.cs</span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title">MovieDetailResponseModel</span></span><br><span class="line">    &#123;</span><br><span class="line">        <span class="keyword">public</span> <span class="built_in">int</span> Id &#123; <span class="keyword">get</span>; <span class="keyword">set</span>; &#125;</span><br><span class="line">        <span class="keyword">public</span> <span class="built_in">string</span> Title &#123; <span class="keyword">get</span>; <span class="keyword">set</span>; &#125;</span><br><span class="line">       </span><br><span class="line">        ...</span><br><span class="line">  </span><br><span class="line">        <span class="keyword">public</span> List&lt;CastResponseModel&gt; Casts &#123; <span class="keyword">get</span>; <span class="keyword">set</span>; &#125;</span><br><span class="line">        </span><br><span class="line">        <span class="keyword">public</span> <span class="keyword">class</span> <span class="title">CastResponseModel</span></span><br><span class="line">        &#123;</span><br><span class="line">            <span class="keyword">public</span> <span class="built_in">int</span> Id &#123; <span class="keyword">get</span>; <span class="keyword">set</span>; &#125;</span><br><span class="line">            <span class="keyword">public</span> <span class="built_in">string</span> Name &#123; <span class="keyword">get</span>; <span class="keyword">set</span>; &#125;</span><br><span class="line">            <span class="keyword">public</span> <span class="built_in">string</span> Gender &#123; <span class="keyword">get</span>; <span class="keyword">set</span>; &#125;</span><br><span class="line">            <span class="keyword">public</span> <span class="built_in">string</span> TmdbUrl &#123; <span class="keyword">get</span>; <span class="keyword">set</span>; &#125;</span><br><span class="line">            <span class="keyword">public</span> <span class="built_in">string</span> ProfilePath &#123; <span class="keyword">get</span>; <span class="keyword">set</span>; &#125;</span><br><span class="line">            <span class="keyword">public</span> <span class="built_in">string</span> Character &#123; <span class="keyword">get</span>; <span class="keyword">set</span>; &#125;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">public</span> List&lt;GenreResponseModel&gt; Genres &#123; <span class="keyword">get</span>; <span class="keyword">set</span>; &#125;</span><br><span class="line">        <span class="keyword">public</span> <span class="keyword">class</span> <span class="title">GenreResponseModel</span></span><br><span class="line">        &#123;</span><br><span class="line">            <span class="keyword">public</span> <span class="built_in">int</span> Id &#123; <span class="keyword">get</span>; <span class="keyword">set</span>; &#125;</span><br><span class="line">            <span class="keyword">public</span> <span class="built_in">string</span> Name &#123; <span class="keyword">get</span>; <span class="keyword">set</span>; &#125;</span><br><span class="line"></span><br><span class="line">        </span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">//EfRepository.cs</span></span><br><span class="line"><span class="function"><span class="keyword">public</span> <span class="keyword">virtual</span> <span class="keyword">async</span> Task&lt;T&gt; <span class="title">GetByIdWithIncludesAsync</span>(<span class="params"><span class="built_in">int</span> id,Expression&lt;Func&lt;T, <span class="built_in">bool</span>&gt;&gt; filter, Func&lt;IQueryable&lt;T&gt;, IIncludableQueryable&lt;T, <span class="built_in">object</span>&gt;&gt; include = <span class="literal">null</span></span>)</span></span><br><span class="line"><span class="function"></span></span><br><span class="line"><span class="function"></span>        &#123;</span><br><span class="line">            <span class="keyword">var</span> query = _dbContext.Set&lt;T&gt;().AsQueryable();</span><br><span class="line"></span><br><span class="line">            <span class="keyword">if</span> (include != <span class="literal">null</span>)</span><br><span class="line">                query = include(query);</span><br><span class="line">            </span><br><span class="line">            <span class="keyword">if</span> (filter != <span class="literal">null</span>)</span><br><span class="line">                query = query.Where(filter);</span><br><span class="line"></span><br><span class="line">            <span class="keyword">return</span> <span class="keyword">await</span> query.SingleOrDefaultAsync();</span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">//MovieRepository.cs</span></span><br><span class="line"> <span class="function"><span class="keyword">public</span> <span class="keyword">async</span> Task&lt;Movie&gt; <span class="title">GetMovieWithGenresAndCast</span>(<span class="params"><span class="built_in">int</span> id</span>)</span></span><br><span class="line"><span class="function"></span>        &#123;</span><br><span class="line">            </span><br><span class="line">            <span class="keyword">var</span> movie = GetByIdWithIncludesAsync(id: id, filter: m =&gt; m.Id == id, </span><br><span class="line">                include:m =&gt;m</span><br><span class="line">                    .Include( m=&gt;m.MovieCasts)</span><br><span class="line">                    .ThenInclude(mc=&gt;mc.Cast)</span><br><span class="line">                    .Include(m=&gt;m.MovieGenres)</span><br><span class="line">                    .ThenInclude(mg=&gt;mg.Genre) );</span><br><span class="line">            <span class="keyword">return</span> <span class="keyword">await</span> movie;</span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">//MovieService</span></span><br><span class="line">   <span class="function"><span class="keyword">public</span> <span class="keyword">async</span> Task&lt;MovieDetailResponseModel&gt; <span class="title">GetMovieDetailsById</span>(<span class="params"><span class="built_in">int</span> id</span>)</span></span><br><span class="line"><span class="function"></span>        &#123;</span><br><span class="line">            <span class="keyword">var</span> movie = <span class="keyword">await</span> _movieRepository.GetMovieWithGenresAndCast(id);</span><br><span class="line">            <span class="keyword">var</span> movieDetailResponseModel = _mapper.Map&lt;Movie,MovieDetailResponseModel&gt;(movie);</span><br><span class="line">            <span class="keyword">return</span> movieDetailResponseModel;</span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="comment">//MappingProfile</span></span><br><span class="line">   CreateMap&lt;Movie, MovieDetailResponseModel&gt;()</span><br><span class="line">                    .ForMember(md =&gt; md.Casts, opt =&gt; opt.MapFrom(src =&gt; GetCasts(src)))</span><br><span class="line">                    .ForMember(md =&gt; md.Genres, opt =&gt; opt.MapFrom(src =&gt; GetGenres(src.MovieGenres)));</span><br><span class="line"></span><br><span class="line">           </span><br><span class="line"></span><br><span class="line"><span class="comment">//MappingProfile</span></span><br><span class="line">  <span class="keyword">private</span> <span class="keyword">static</span> List&lt;MovieDetailResponseModel.CastResponseModel&gt; GetCasts(Movie movie)</span><br><span class="line">        &#123;</span><br><span class="line">            IEnumerable&lt;MovieCast&gt; srcMovieCasts = movie.MovieCasts;</span><br><span class="line">            <span class="keyword">var</span> movieDetailResponseModel = <span class="keyword">new</span> MovieDetailResponseModel</span><br><span class="line">            &#123;</span><br><span class="line">                Casts = <span class="keyword">new</span> List&lt;MovieDetailResponseModel.CastResponseModel&gt;(),</span><br><span class="line">                </span><br><span class="line">            &#125;;</span><br><span class="line">            <span class="keyword">foreach</span> (<span class="keyword">var</span> cast <span class="keyword">in</span> srcMovieCasts)</span><br><span class="line">            &#123;</span><br><span class="line">                movieDetailResponseModel.Casts.Add(<span class="keyword">new</span> MovieDetailResponseModel.CastResponseModel</span><br><span class="line">                &#123;</span><br><span class="line">                    Id = cast.CastId,</span><br><span class="line">                    Gender = cast.Cast.Gender,</span><br><span class="line">                    Name = cast.Cast.Name,</span><br><span class="line">                    ProfilePath = cast.Cast.ProfilePath,</span><br><span class="line">                    TmdbUrl = cast.Cast.TmdbUrl,</span><br><span class="line">                    Character = cast.Character</span><br><span class="line">                &#125;);</span><br><span class="line">            &#125;</span><br><span class="line">            </span><br><span class="line">            <span class="keyword">return</span> movieDetailResponseModel.Casts;</span><br><span class="line">        &#125;</span><br><span class="line">        </span><br><span class="line">        <span class="keyword">private</span> <span class="keyword">static</span> List&lt;MovieDetailResponseModel.GenreResponseModel&gt; GetGenres(IEnumerable&lt;MovieGenre&gt; srcMovieGenres)</span><br><span class="line">        &#123;</span><br><span class="line">            <span class="keyword">var</span> movieDetailResponseModel = <span class="keyword">new</span> MovieDetailResponseModel</span><br><span class="line">            &#123;</span><br><span class="line">                Genres = <span class="keyword">new</span> List&lt;MovieDetailResponseModel.GenreResponseModel&gt;(),</span><br><span class="line">                </span><br><span class="line">            &#125;;</span><br><span class="line">            <span class="keyword">foreach</span> (<span class="keyword">var</span> genre <span class="keyword">in</span> srcMovieGenres)</span><br><span class="line">                movieDetailResponseModel.Genres.Add(<span class="keyword">new</span> MovieDetailResponseModel.GenreResponseModel</span><br><span class="line">                &#123;</span><br><span class="line">                    Id = genre.GenreId,</span><br><span class="line">                   </span><br><span class="line">                    Name = genre.Genre.Name,</span><br><span class="line">                    </span><br><span class="line">                &#125;);</span><br><span class="line"></span><br><span class="line">            <span class="keyword">return</span> movieDetailResponseModel.Genres;</span><br><span class="line">        &#125;</span><br></pre></td></tr></table></figure>
</article><div class="post-copyright"><div class="post-copyright__author"><span class="post-copyright-meta">Author: </span><span class="post-copyright-info"><a href="mailto:undefined">Shiqi Zhang</a></span></div><div class="post-copyright__type"><span class="post-copyright-meta">Link: </span><span class="post-copyright-info"><a href="http://pajarnas.github.io/06/16/2021/ASP%20Pagination/">http://pajarnas.github.io/06/16/2021/ASP%20Pagination/</a></span></div><div class="post-copyright__notice"><span class="post-copyright-meta">Copyright Notice: </span><span class="post-copyright-info">All articles in this blog are licensed under <a target="_blank" rel="noopener" href="https://creativecommons.org/licenses/by-nc-sa/4.0/">CC BY-NC-SA 4.0</a> unless stating additionally.</span></div></div><div class="tag_share"><div class="post-meta__tag-list"><a class="post-meta__tags" href="/tags/notes/">notes</a><a class="post-meta__tags" href="/tags/Entity-Framework/">Entity Framework</a><a class="post-meta__tags" href="/tags/Automapper/">Automapper</a></div><div class="post_share"><div class="social-share" data-image="https://cdn.jsdelivr.net/npm/butterfly-extsrc@1/img/default.jpg" data-sites="facebook,twitter,wechat,weibo,qq"></div><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/social-share.js/dist/css/share.min.css" media="print" onload="this.media='all'"><script src="https://cdn.jsdelivr.net/npm/social-share.js/dist/js/social-share.min.js" defer></script></div></div><nav class="pagination-post" id="pagination"><div class="prev-post pull-left"><a href="/06/16/2021/Security/"><img class="prev-cover" src="https://cdn.jsdelivr.net/npm/butterfly-extsrc@1/img/default.jpg" onerror="onerror=null;src='/img/404.jpg'" alt="cover of previous post"><div class="pagination-info"><div class="label">Previous Post</div><div class="prev_info">Angular Routing</div></div></a></div><div class="next-post pull-right"><a href="/06/16/2021/Angular:%20Data%20Binding/"><img class="next-cover" src="https://cdn.jsdelivr.net/npm/butterfly-extsrc@1/img/default.jpg" onerror="onerror=null;src='/img/404.jpg'" alt="cover of next post"><div class="pagination-info"><div class="label">Next Post</div><div class="next_info">Angular Routing</div></div></a></div></nav><div class="relatedPosts"><div class="headline"><i class="fas fa-thumbs-up fa-fw"></i><span> Related Articles</span></div><div class="relatedPosts-list"><div><a href="/06/16/2021/ASP Automapper/" title="ASP Pagination Implementation Based On Entity Framework"><img class="cover" src="https://cdn.jsdelivr.net/npm/butterfly-extsrc@1/img/default.jpg" alt="cover"><div class="content is-center"><div class="date"><i class="far fa-calendar-alt fa-fw"></i> 06-16-2021</div><div class="title">ASP Pagination Implementation Based On Entity Framework</div></div></a></div><div><a href="/05/11/2021/ASP I: Entity Framework/" title="ASP I Entity Framework"><img class="cover" src="https://cdn.jsdelivr.net/npm/butterfly-extsrc@1/img/default.jpg" alt="cover"><div class="content is-center"><div class="date"><i class="far fa-calendar-alt fa-fw"></i> 05-11-2021</div><div class="title">ASP I Entity Framework</div></div></a></div><div><a href="/06/16/2021/Angular : References/" title="Angular References"><img class="cover" src="https://cdn.jsdelivr.net/npm/butterfly-extsrc@1/img/default.jpg" alt="cover"><div class="content is-center"><div class="date"><i class="far fa-calendar-alt fa-fw"></i> 06-16-2021</div><div class="title">Angular References</div></div></a></div><div><a href="/06/16/2021/Angular I: Core/" title="Angular I Core"><img class="cover" src="https://cdn.jsdelivr.net/npm/butterfly-extsrc@1/img/default.jpg" alt="cover"><div class="content is-center"><div class="date"><i class="far fa-calendar-alt fa-fw"></i> 06-16-2021</div><div class="title">Angular I Core</div></div></a></div><div><a href="/06/16/2021/Angular II: Services/" title="Angular II Services"><img class="cover" src="https://cdn.jsdelivr.net/npm/butterfly-extsrc@1/img/default.jpg" alt="cover"><div class="content is-center"><div class="date"><i class="far fa-calendar-alt fa-fw"></i> 06-16-2021</div><div class="title">Angular II Services</div></div></a></div><div><a href="/06/16/2021/Angular: Routing/" title="Angular Routing"><img class="cover" src="https://cdn.jsdelivr.net/npm/butterfly-extsrc@1/img/default.jpg" alt="cover"><div class="content is-center"><div class="date"><i class="far fa-calendar-alt fa-fw"></i> 06-16-2021</div><div class="title">Angular Routing</div></div></a></div></div></div><hr/><div id="post-comment"><div class="comment-head"><div class="comment-headline"><i class="fas fa-comments fa-fw"></i><span> Comment</span></div><div id="comment-switch"><span class="first-comment">Livere</span><span class="switch-btn"></span><span class="second-comment">Waline</span></div></div><div class="comment-wrap"><div><div id="lv-container" data-id="city" data-uid="MTAyMC81Mjk2MS8yOTQzOA=="></div></div><div><div id="waline-wrap"></div></div></div></div></div><div class="aside-content" id="aside-content"><div class="card-widget card-info"><div class="card-info-avatar is-center"><img class="avatar-img" src="/img/pajarnas.jpg" onerror="this.onerror=null;this.src='/img/friend_404.gif'" alt="avatar"/><div class="author-info__name">Shiqi Zhang</div><div class="author-info__description">Personal website</div></div><div class="card-info-data"><div class="card-info-data-item is-center"><a href="/archives/"><div class="headline">Articles</div><div class="length-num">36</div></a></div><div class="card-info-data-item is-center"><a href="/tags/"><div class="headline">Tags</div><div class="length-num">51</div></a></div><div class="card-info-data-item is-center"><a href="/categories/"><div class="headline">Categories</div><div class="length-num">11</div></a></div></div><a class="button--animated" id="card-info-btn" target="_blank" rel="noopener" href="https://github.com/xxxxxx"><i class="fab fa-github"></i><span>Follow Me</span></a><div class="card-info-social-icons is-center"><a class="social-icon" href="https://github.com/pajarnas" target="_blank" title="Github"><i class="fab fa-github"></i></a><a class="social-icon" href="mailto:saigezhang17@gmail.com" target="_blank" title="Email"><i class="fas fa-envelope"></i></a></div></div><div class="sticky_layout"><div class="card-widget" id="card-toc"><div class="item-headline"><i class="fas fa-stream"></i><span>Catalog</span></div><div class="toc-content"><ol class="toc"><li class="toc-item toc-level-1"><a class="toc-link" href="#Introduction"><span class="toc-text">Introduction</span></a></li><li class="toc-item toc-level-1"><a class="toc-link" href="#Code"><span class="toc-text">Code</span></a></li><li class="toc-item toc-level-1"><a class="toc-link" href="#Another-Automapper-Example"><span class="toc-text">Another Automapper Example</span></a></li></ol></div></div><div class="card-widget card-recent-post"><div class="item-headline"><i class="fas fa-history"></i><span>Recent Post</span></div><div class="aside-list"><div class="aside-list-item no-cover"><div class="content"><a class="title" href="/06/16/2021/ASP%20Automapper/" title="ASP Pagination Implementation Based On Entity Framework">ASP Pagination Implementation Based On Entity Framework</a><time datetime="2021-06-16T05:00:00.000Z" title="Created 06-16-2021 00:00:00">06-16-2021</time></div></div><div class="aside-list-item no-cover"><div class="content"><a class="title" href="/06/16/2021/Angular%20:%20References/" title="Angular References">Angular References</a><time datetime="2021-06-16T05:00:00.000Z" title="Created 06-16-2021 00:00:00">06-16-2021</time></div></div><div class="aside-list-item no-cover"><div class="content"><a class="title" href="/06/16/2021/Angular%20I:%20Core/" title="Angular I Core">Angular I Core</a><time datetime="2021-06-16T05:00:00.000Z" title="Created 06-16-2021 00:00:00">06-16-2021</time></div></div><div class="aside-list-item no-cover"><div class="content"><a class="title" href="/06/16/2021/Angular%20II:%20Services/" title="Angular II Services">Angular II Services</a><time datetime="2021-06-16T05:00:00.000Z" title="Created 06-16-2021 00:00:00">06-16-2021</time></div></div><div class="aside-list-item no-cover"><div class="content"><a class="title" href="/06/16/2021/Angular:%20Routing/" title="Angular Routing">Angular Routing</a><time datetime="2021-06-16T05:00:00.000Z" title="Created 06-16-2021 00:00:00">06-16-2021</time></div></div></div></div></div></div></main><footer id="footer"><div id="footer-wrap"><div class="copyright">&copy;2020 - 2021 By Shiqi Zhang</div><div class="framework-info"><span>Framework </span><a target="_blank" rel="noopener" href="https://hexo.io">Hexo</a><span class="footer-separator">|</span><span>Theme </span><a target="_blank" rel="noopener" href="https://github.com/jerryc127/hexo-theme-butterfly">Butterfly</a></div></div></footer></div><div id="rightside"><div id="rightside-config-hide"><button id="readmode" type="button" title="Read Mode"><i class="fas fa-book-open"></i></button><button id="darkmode" type="button" title="Switch Between Light And Dark Mode"><i class="fas fa-adjust"></i></button><button id="hide-aside-btn" type="button" title="Toggle between single-column and double-column"><i class="fas fa-arrows-alt-h"></i></button></div><div id="rightside-config-show"><button id="rightside_config" type="button" title="Setting"><i class="fas fa-cog fa-spin"></i></button><button class="close" id="mobile-toc-button" type="button" title="Table Of Contents"><i class="fas fa-list-ul"></i></button><a id="to_comment" href="#post-comment" title="Scroll To Comments"><i class="fas fa-comments"></i></a><button id="go-up" type="button" title="Back To Top"><i class="fas fa-arrow-up"></i></button></div></div><div><script src="/js/utils.js"></script><script src="/js/main.js"></script><div class="js-pjax"><script>function loadLivere () {
  if (typeof LivereTower === 'object') {
    window.LivereTower.init()
  }
  else {
    (function(d, s) {
        var j, e = d.getElementsByTagName(s)[0];
        if (typeof LivereTower === 'function') { return; }
        j = d.createElement(s);
        j.src = 'https://cdn-city.livere.com/js/embed.dist.js';
        j.async = true;
        e.parentNode.insertBefore(j, e);
    })(document, 'script');
  }
}

if ('Livere' === 'Livere' || !false) {
  if (false) btf.loadComment(document.getElementById('lv-container'), loadLivere)
  else loadLivere()
}
else {
  function loadOtherComment () {
    loadLivere()
  }
}</script><script>function loadWaline () {
  function initWaline () {
    let initData = {
      el: '#waline-wrap',
      serverURL: 'n9jnbwbv.us-w1-cname.avosapps.us',
      avatar: 'monsterid',
      path: location.pathname,
      emojiCDN: '',
      emojiMaps: "",
    }
    
    if (false) {
      const otherData = false
      initData = Object.assign(initData, otherData)
    }
    
    const waline = new Waline(initData)
  }

  if (typeof Waline === 'function') initWaline() 
  else getScript('https://cdn.jsdelivr.net/npm/@waline/client/dist/Waline.min.js').then(initWaline)
}

if ('Livere' === 'Waline' || !false) {
  if (false) btf.loadComment(document.getElementById('waline-wrap'),loadWaline)
  else setTimeout(loadWaline, 0)
} else {
  function loadOtherComment () {
    loadWaline()
  }
}</script></div><script async data-pjax src="//busuanzi.ibruce.info/busuanzi/2.3/busuanzi.pure.mini.js"></script></div></body></html>